# 技術架構文件 - 卡在國際通

## 專案技術棧

### 前端技術
- **HTML5**：語意化標籤、響應式設計
- **CSS3**：Flexbox、Grid、CSS Variables、動畫效果
- **JavaScript (ES6+)**：原生 JavaScript，不使用框架

### 第三方服務
- **Google Maps JavaScript API**：地圖顯示與互動
- **OpenWeather API**：天氣資訊
- **ExchangeRate-API**：匯率換算

---

## 專案資料夾結構

```
stuck-in-kokusai-street/
├── index.html                 # 首頁（打包清單）
├── itinerary.html            # 行程總覽
├── day1.html                 # Day 1 詳細行程
├── day2.html                 # Day 2 詳細行程
├── day3.html                 # Day 3 詳細行程
├── day4.html                 # Day 4 詳細行程
│
├── css/
│   ├── reset.css             # CSS Reset
│   ├── variables.css         # CSS 變數（顏色、字型、間距）
│   ├── common.css            # 共用樣式（Header、Footer、按鈕等）
│   ├── home.css              # 首頁專用樣式
│   ├── itinerary.css         # 行程總覽樣式
│   └── day.css               # 單日行程樣式
│
├── js/
│   ├── config.js             # API Keys 與設定
│   ├── common.js             # 共用功能（導覽列、Footer、語言切換）
│   ├── packing-list.js       # 打包清單功能
│   ├── weather.js            # 天氣 API 整合
│   ├── currency.js           # 匯率換算功能
│   ├── map.js                # Google Maps 整合
│   └── data.js               # 行程資料（JSON 格式）
│
├── images/
│   ├── hero/                 # Hero 主視覺圖片
│   ├── attractions/          # 景點照片
│   ├── food/                 # 美食照片
│   ├── icons/                # 圖示
│   └── misc/                 # 其他圖片
│
├── assets/
│   └── fonts/                # 自訂字體（如需要）
│
├── data/
│   └── itinerary.json        # 行程資料（也可直接寫在 data.js）
│
└── README.md                 # 專案說明文件
```

---

## 技術細節

### HTML 結構

每個 HTML 頁面基本結構：

```html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="...">
    <title>卡在國際通 - 沖繩四天兩夜完美行程</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/[page-specific].css">

    <!-- Favicon -->
    <link rel="icon" href="images/favicon.ico">
</head>
<body>
    <!-- Header / Navigation -->
    <header id="header"></header>

    <!-- Main Content -->
    <main>
        <!-- 頁面內容 -->
    </main>

    <!-- Footer -->
    <footer id="footer"></footer>

    <!-- JavaScript -->
    <script src="js/config.js"></script>
    <script src="js/common.js"></script>
    <script src="js/[page-specific].js"></script>
</body>
</html>
```

### CSS 架構

**1. CSS Reset (reset.css)**
- 統一瀏覽器預設樣式
- Box-sizing 設定

**2. CSS Variables (variables.css)**
```css
:root {
    /* Colors */
    --primary-color: #1E88E5;
    --primary-light: #42A5F5;
    --secondary-color: #FF7043;
    --accent-color: #FFA726;
    --bg-white: #FFFFFF;
    --bg-light: #F5F5F5;
    --text-dark: #333333;
    --text-gray: #666666;

    /* Typography */
    --font-main: 'Noto Sans TC', sans-serif;
    --font-size-h1: 32px;
    --font-size-h2: 28px;
    --font-size-body: 16px;

    /* Spacing */
    --spacing-xs: 8px;
    --spacing-sm: 16px;
    --spacing-md: 24px;
    --spacing-lg: 32px;
    --spacing-xl: 48px;

    /* Breakpoints (用於 JS) */
    --breakpoint-mobile: 768px;
    --breakpoint-tablet: 1024px;
}
```

**3. Common Styles (common.css)**
- Header、Footer、按鈕、卡片等共用組件
- RWD 響應式設計

**4. Page-specific Styles**
- 各頁面專屬樣式

### JavaScript 架構

**模組化設計**：每個 JS 檔案負責特定功能

**1. config.js**
```javascript
const CONFIG = {
    GOOGLE_MAPS_API_KEY: 'YOUR_API_KEY',
    WEATHER_API_KEY: 'YOUR_API_KEY',
    CURRENCY_API_KEY: 'YOUR_API_KEY',
    DEFAULT_LANG: 'zh-TW',
};
```

**2. common.js**
- 導覽列動態生成
- Footer 動態生成
- 語言切換功能
- Mobile Menu 控制

**3. packing-list.js**
- 打包清單資料
- 勾選/取消勾選
- LocalStorage 儲存與讀取
- 新增/刪除自訂項目
- 進度計算

**4. weather.js**
- 呼叫 Weather API
- 顯示未來 4 天天氣

**5. currency.js**
- 呼叫匯率 API
- 即時換算 TWD ↔ JPY

**6. map.js**
- Google Maps 初始化
- 標記景點位置
- 路線規劃

**7. data.js**
- 儲存所有行程資料
- 可用 JavaScript Object 或載入 JSON

---

## LocalStorage 資料結構

```javascript
// 打包清單狀態
localStorage.setItem('packingList', JSON.stringify({
    documents: {
        passport: true,
        ticket: false,
        // ...
    },
    clothing: {
        tshirt: true,
        // ...
    },
    customItems: [
        { id: 'custom1', text: '自訂物品1', checked: false }
    ]
}));

// 語言設定
localStorage.setItem('language', 'zh-TW'); // or 'en'
```

---

## API 整合

### 1. Google Maps API

**載入方式**：
```html
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap&language=zh-TW">
</script>
```

**功能**：
- 顯示景點標記
- 點擊標記顯示資訊視窗
- 路線規劃（選用）

### 2. OpenWeather API

**API Endpoint**：
```
https://api.openweathermap.org/data/2.5/forecast?q=Okinawa,JP&appid=YOUR_API_KEY&units=metric&lang=zh_tw
```

**顯示內容**：
- 未來 4 天天氣
- 溫度、天氣狀況、降雨機率

### 3. ExchangeRate API

**API Endpoint**：
```
https://api.exchangerate-api.com/v4/latest/TWD
```

**功能**：
- TWD ↔ JPY 換算
- 顯示即時匯率

---

## 響應式設計策略

### Breakpoints
```css
/* Mobile First Approach */

/* Mobile: < 768px (預設) */
/* Tablet: 768px ~ 1023px */
@media (min-width: 768px) { ... }

/* Desktop: 1024px+ */
@media (min-width: 1024px) { ... }
```

### 關鍵技術
- **Flexbox**：導覽列、卡片排列
- **CSS Grid**：行程卡片網格佈局
- **Media Queries**：響應式斷點
- **Mobile Menu**：漢堡選單（< 768px）

---

## 效能優化

### 1. 圖片優化
- 使用 WebP 格式（提供 fallback）
- 圖片壓縮（建議使用 TinyPNG）
- Lazy Loading（使用 `loading="lazy"`）
- Responsive Images（使用 `srcset`）

```html
<img
    src="images/attractions/shuri-castle-800.webp"
    srcset="images/attractions/shuri-castle-400.webp 400w,
            images/attractions/shuri-castle-800.webp 800w,
            images/attractions/shuri-castle-1200.webp 1200w"
    sizes="(max-width: 768px) 100vw, 50vw"
    alt="首里城"
    loading="lazy"
>
```

### 2. CSS 優化
- 使用 CSS Variables 統一管理
- 避免過度巢狀
- 使用 `will-change` 提示瀏覽器優化動畫
- 最小化 CSS 檔案（生產環境）

### 3. JavaScript 優化
- 延遲載入非關鍵 JS（`defer` 或 `async`）
- 事件委派 (Event Delegation)
- Debounce / Throttle 處理頻繁事件
- LocalStorage 快取 API 回應

### 4. 快取策略
```javascript
// 快取 API 回應 1 小時
function getCachedData(key, fetchFunction) {
    const cached = localStorage.getItem(key);
    if (cached) {
        const { data, timestamp } = JSON.parse(cached);
        const oneHour = 60 * 60 * 1000;
        if (Date.now() - timestamp < oneHour) {
            return Promise.resolve(data);
        }
    }

    return fetchFunction().then(data => {
        localStorage.setItem(key, JSON.stringify({
            data,
            timestamp: Date.now()
        }));
        return data;
    });
}
```

---

## 瀏覽器相容性

### 必須支援的瀏覽器
- Chrome 90+
- Safari 14+
- Firefox 88+
- Edge 90+

### Polyfills（如需要）
- `fetch` API（舊瀏覽器）
- `Promise`（IE11，但我們不支援）

### 漸進式增強
- 核心功能不依賴 JavaScript 也能運作
- CSS Grid 使用 `@supports` 檢測
- 提供降級方案

---

## 部署方案

### 選項 1: GitHub Pages（推薦）
1. Push 程式碼到 GitHub Repository
2. 在 Settings > Pages 中啟用
3. 選擇 main branch
4. 網址：`https://[username].github.io/stuck-in-kokusai-street/`

### 選項 2: Netlify
1. 連結 GitHub Repository
2. 自動部署
3. 提供免費 SSL
4. 自訂網域

### 選項 3: Vercel
1. 連結 GitHub Repository
2. 自動部署
3. 優秀的效能

---

## 開發工作流程

### 1. 本地開發
使用簡單的 HTTP Server：

```bash
# Python 3
python -m http.server 8000

# Node.js (需要先安裝 http-server)
npx http-server -p 8000

# VS Code Live Server 擴充套件
```

瀏覽器開啟：`http://localhost:8000`

### 2. 版本控制
```bash
git add .
git commit -m "feat: 新增打包清單功能"
git push origin main
```

### 3. 測試流程
- 在不同瀏覽器測試
- 使用瀏覽器開發者工具測試 RWD
- 使用 Lighthouse 檢測效能

---

## 安全性考量

### 1. API Keys
- 不要將 API Keys 直接 commit 到 Git
- 使用環境變數或 config 檔案（加入 .gitignore）
- Google Maps API 設定網域白名單

### 2. XSS 防護
- 使用 `textContent` 而非 `innerHTML`（當插入使用者輸入時）
- 驗證使用者輸入

### 3. HTTPS
- 生產環境必須使用 HTTPS
- GitHub Pages / Netlify / Vercel 預設提供

---

## 下一步開發順序

### Phase 1: 基礎架構（Week 1）
1. ✅ 建立資料夾結構
2. ⬜ 建立 reset.css、variables.css
3. ⬜ 建立 Header 與 Footer（common.js）
4. ⬜ 建立基本 HTML 頁面框架

### Phase 2: 首頁開發（Week 1-2）
5. ⬜ Hero Section
6. ⬜ 行程快速導覽卡片
7. ⬜ 打包清單功能（含 LocalStorage）
8. ⬜ 天氣、匯率、小貼士區塊

### Phase 3: 行程頁面（Week 2-3）
9. ⬜ 行程總覽頁面
10. ⬜ Day 1-4 詳細行程頁面
11. ⬜ Google Maps 整合

### Phase 4: 優化與測試（Week 3-4）
12. ⬜ RWD 調整
13. ⬜ 效能優化
14. ⬜ 跨瀏覽器測試
15. ⬜ 部署上線

---

## 總結

使用純 HTML + CSS + JavaScript 的優勢：
- ✅ 無需編譯打包，開發快速
- ✅ 學習曲線低
- ✅ 效能優異（無框架 overhead）
- ✅ 容易部署（靜態檔案）
- ✅ SEO 友善

這個架構完全能夠實現所有設計的功能，並保持程式碼清晰、易於維護！
